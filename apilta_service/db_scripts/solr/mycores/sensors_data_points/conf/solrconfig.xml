<?xml version="1.0" encoding="UTF-8" ?>
<!--
 Copyright 2016 Tampere University of Technology, Pori Department
 
 Licensed under the Apache License, Version 2.0 (the "License");
 you may not use this file except in compliance with the License.
 You may obtain a copy of the License at
 
  http://www.apache.org/licenses/LICENSE-2.0
 
 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.

 This file incorporates code covered by the following terms:

 Licensed to the Apache Software Foundation (ASF) under one or more
 contributor license agreements.  See the NOTICE file distributed with
 this work for additional information regarding copyright ownership.
 The ASF licenses this file to You under the Apache License, Version 2.0
 (the "License"); you may not use this file except in compliance with
 the License.  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

 Unless required by applicable law or agreed to in writing, software
 distributed under the License is distributed on an "AS IS" BASIS,
 WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 See the License for the specific language governing permissions and
 limitations under the License.
-->

<config>
  <luceneMatchVersion>6.0.0</luceneMatchVersion>
 
  <dataDir>${solr.data.dir:}</dataDir>
	
  <directoryFactory name="DirectoryFactory" class="${solr.directoryFactory:solr.NRTCachingDirectoryFactory}"/>
  <codecFactory class="solr.SchemaCodecFactory"/>

  <schemaFactory class="ClassicIndexSchemaFactory"/>

  <!-- The default high-performance update handler -->
  <updateHandler class="solr.DirectUpdateHandler2">
    <updateLog>
      <str name="dir">${solr.ulog.dir:}</str>
	  <int name="numVersionBuckets">${solr.ulog.numVersionBuckets:65536}</int>
    </updateLog>
	<autoCommit> 
		<maxDocs>10000</maxDocs>
		<maxTime>900000</maxTime>	<!-- 900000ms/15 minutes between hard commits -->
		<openSearcher>false</openSearcher> 
	</autoCommit>
	<autoSoftCommit>
      <maxTime>300000</maxTime>	<!-- 300000ms/5 minutes between soft commits -->
    </autoSoftCommit>
  </updateHandler>
  
  <query>
    <!-- Max Boolean Clauses

         Maximum number of clauses in each BooleanQuery,  an exception
         is thrown if exceeded.

         ** WARNING **
         
         This option actually modifies a global Lucene property that
         will affect all SolrCores.  If multiple solrconfig.xml files
         disagree on this property, the value at any given moment will
         be based on the last SolrCore to be initialized.
         
      -->
    <maxBooleanClauses>1048576</maxBooleanClauses>
	
	<filterCache class="solr.FastLRUCache"
			size="512"
			initialSize="512"
			autowarmCount="0"/>
	<queryResultCache class="solr.LRUCache"
			size="512"
			initialSize="512"
			autowarmCount="0"/>
	<documentCache class="solr.LRUCache"
			size="512"
			initialSize="512"
			autowarmCount="0"/>
	<cache name="perSegFilter"
			class="solr.search.LRUCache"
			size="10"
			initialSize="0"
			autowarmCount="10"
			regenerator="solr.NoOpRegenerator" />
	<enableLazyFieldLoading>true</enableLazyFieldLoading>
	<useColdSearcher>false</useColdSearcher>
  </query>

  <requestHandler name="/get" class="solr.RealTimeGetHandler">
    <lst name="defaults">
      <str name="omitHeader">true</str>
    </lst>
  </requestHandler>
  
  <requestHandler name="/replication" class="solr.ReplicationHandler" startup="lazy" /> 

  <requestDispatcher handleSelect="false" >
    <requestParsers
		enableRemoteStreaming="false"
		multipartUploadLimitInKB="2048000"
		formdataUploadLimitInKB="2048"
		addHttpRequestToContext="false" />
	<httpCaching never304="true" />
  </requestDispatcher>
  
	<requestHandler name="/select" class="solr.SearchHandler">
		<!-- default values for query parameters can be specified, these
		will be overridden by parameters in the request
		-->
		<lst name="defaults">
			<str name="echoParams">explicit</str>
			<int name="rows">10</int>
		</lst>
	</requestHandler>
	
	<!-- A request handler that returns indented JSON by default -->
	<requestHandler name="/query" class="solr.SearchHandler">
		<lst name="defaults">
			<str name="echoParams">explicit</str>
			<str name="wt">json</str>
			<str name="indent">true</str>
		</lst>
	</requestHandler>
  
  <requestHandler name="/analysis/field" startup="lazy" class="solr.FieldAnalysisRequestHandler" />
  <requestHandler name="/update" class="solr.UpdateRequestHandler"  />

  <requestHandler name="/admin/ping" class="solr.PingRequestHandler">
    <lst name="invariants">
      <str name="q">solrpingquery</str>
    </lst>
    <lst name="defaults">
      <str name="echoParams">all</str>
    </lst>
  </requestHandler>

  <!-- config for the admin interface --> 
  <admin>
    <defaultQuery>solr</defaultQuery>
  </admin>
  
  <!-- Legacy config for the admin interface -->
  <admin>
    <defaultQuery>*:*</defaultQuery>
  </admin>
</config>
